<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script type="text/javascript">
    Office.onReady(function (info) {
      if (info.host === Office.HostType.Outlook) {
        console.log("Outlook OnSend add-in ready.");
      }
    });

    function onMessageSendHandler(event) {
      console.log("onMessageSendHandler fired");
      alert("Sending email...");
      event.completed({ allowEvent: true });
    }

    Office.actions.associate("onMessageSendHandler", onMessageSendHandler);
  </script>
</head>
<body>OnSend test loaded.</body>
</html>
